---
title: "matrice regions"
author: "Alia"
date: "04/07/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Importation
```{r }
load(paste0("matrice_regions_14SD04701"))
         
X<-unlist(m[-1,1])
Y<-unlist(m[-1,2])
      
phenotypes1 <- m[1,3]
all_phenotypes <- matrix(unlist(m[-1,3]), nrow=length(as.matrix(phenotypes1[[1]]))+1)#le +1 correspond a la case panel_present

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

X et Y = listes des coordonnées

**Vecteur X**
```{r}
X

```


**all_phenotypes = plusieurs lignes avec par ligne le type de phenotype et par colonne la case (dans chaque case il y a plusieurs cellules)**
```{r}
View(all_phenotypes)
```

Donc dans une colonne on a : nombre de cellules du phenotype1, nombre de cellules du phenotype2, nombre de cellules du phenotype3...

**Noms des phenotypes**
```{r}
phenotypes1
```


## Comparaison de CD68+pSTAT1+ et CD8+PD1+
```{r}
a = all_phenotypes[7,]
b = all_phenotypes[16,]
for(i in 0:length(a)){
  c = max(b[a=i])
  a = a[max(b[a=i])]
}
c
plot(a, c)
```
Changement de l'échelle
```{r}
b = log(b)
hist(a)
hist(b)
```



On enlève est b=0
```{r}
a = a[b>0]
b = b[b>0]
```

Nouveau plot
```{r}
plot(a, b)
abline(lm1)
```


Modèle linéaire
```{r}
lm1 = lm(b~a)
summary(lm1)
anova(lm1)
```

## Comparaison de tous les phenotypes
```{r}
lm2 = lm(all_phenotypes[14,]~all_phenotypes[1,]*all_phenotypes[2,]*all_phenotypes[3,]*all_phenotypes[4,]*all_phenotypes[5,]*all_phenotypes[6,]*all_phenotypes[7,]*all_phenotypes[8,]*all_phenotypes[9,]*all_phenotypes[10,]*all_phenotypes[11,]*all_phenotypes[12,]*all_phenotypes[13,]*all_phenotypes[15,]*all_phenotypes[16,]*all_phenotypes[17,]*all_phenotypes[18,]*all_phenotypes[20,]*all_phenotypes[21,])
```


